module.exports=[56704,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/work-async-storage.external.js",()=>require("next/dist/server/app-render/work-async-storage.external.js"))},32319,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/work-unit-async-storage.external.js",()=>require("next/dist/server/app-render/work-unit-async-storage.external.js"))},20635,(a,b,c)=>{b.exports=a.x("next/dist/server/app-render/action-async-storage.external.js",()=>require("next/dist/server/app-render/action-async-storage.external.js"))},34150,(a,b,c)=>{"use strict";b.exports=a.r(96048).vendored.contexts.HooksClientContext},31721,(a,b,c)=>{"use strict";b.exports=a.r(96048).vendored.contexts.ServerInsertedHtml},98295,a=>{"use strict";a.s(["CATEGORIES",0,[{value:"work",label:"ä»•äº‹",defaultColor:"#3B82F6"},{value:"private",label:"ãƒ—ãƒ©ã‚¤ãƒ™ãƒ¼ãƒˆ",defaultColor:"#10B981"},{value:"event",label:"ã‚¤ãƒ™ãƒ³ãƒˆ",defaultColor:"#F59E0B"},{value:"other",label:"ãã®ä»–",defaultColor:"#8B5CF6"}]])},24050,a=>{"use strict";function b(a,b,d){let e=[],f=new Date(a,b-1,1),g=new Date(a,b,0),h=new Date;h.setHours(0,0,0,0);let i=f.getDay(),j=new Date(a,b-1,0).getDate();for(let f=i-1;f>=0;f--){let g=new Date(a,b-2,j-f);e.push({date:g,isCurrentMonth:!1,isToday:!1,schedules:c(g,d)})}for(let f=1;f<=g.getDate();f++){let g=new Date(a,b-1,f),i=new Date(g);i.setHours(0,0,0,0),e.push({date:g,isCurrentMonth:!0,isToday:i.getTime()===h.getTime(),schedules:c(g,d)})}let k=7-e.length%7;if(k<7)for(let f=1;f<=k;f++){let g=new Date(a,b,f);e.push({date:g,isCurrentMonth:!1,isToday:!1,schedules:c(g,d)})}return e}function c(a,b){let c=d(a);return b.filter(a=>a.date===c).sort((a,b)=>a.startTime.localeCompare(b.startTime))}function d(a){let b=a.getFullYear(),c=String(a.getMonth()+1).padStart(2,"0"),d=String(a.getDate()).padStart(2,"0");return`${b}-${c}-${d}`}function e(a,b){return`${a}å¹´${b}æœˆ`}function f(a){return["æ—¥","æœˆ","ç«","æ°´","æœ¨","é‡‘","åœŸ"][a]}function g(a){return!!/^\d{4}-\d{2}-\d{2}$/.test(a)&&!isNaN((function(a){let[b,c,d]=a.split("-").map(Number);return new Date(b,c-1,d)})(a).getTime())}function h(a){if(!/^\d{2}:\d{2}$/.test(a))return!1;let[b,c]=a.split(":").map(Number);return b>=0&&b<24&&c>=0&&c<60}function i(a,b){return a<b}a.s(["formatDate",()=>d,"generateCalendarDays",()=>b,"getDayName",()=>f,"getMonthName",()=>e,"isValidDate",()=>g,"isValidTime",()=>h,"isValidTimeRange",()=>i])},59878,a=>{a.v({button:"ImageUpload-module__5r8nlq__button",buttonPrimary:"ImageUpload-module__5r8nlq__buttonPrimary",buttonSecondary:"ImageUpload-module__5r8nlq__buttonSecondary",container:"ImageUpload-module__5r8nlq__container",dragOver:"ImageUpload-module__5r8nlq__dragOver",error:"ImageUpload-module__5r8nlq__error",fileInput:"ImageUpload-module__5r8nlq__fileInput",loading:"ImageUpload-module__5r8nlq__loading",loadingSpinner:"ImageUpload-module__5r8nlq__loadingSpinner",loadingText:"ImageUpload-module__5r8nlq__loadingText",preview:"ImageUpload-module__5r8nlq__preview",previewActions:"ImageUpload-module__5r8nlq__previewActions",previewImage:"ImageUpload-module__5r8nlq__previewImage",resultItem:"ImageUpload-module__5r8nlq__resultItem",resultItemBadge:"ImageUpload-module__5r8nlq__resultItemBadge",resultItemField:"ImageUpload-module__5r8nlq__resultItemField",resultItemHeader:"ImageUpload-module__5r8nlq__resultItemHeader",resultItemInput:"ImageUpload-module__5r8nlq__resultItemInput",resultItemLabel:"ImageUpload-module__5r8nlq__resultItemLabel",resultItemRow:"ImageUpload-module__5r8nlq__resultItemRow",resultItemSelect:"ImageUpload-module__5r8nlq__resultItemSelect",resultItemTextarea:"ImageUpload-module__5r8nlq__resultItemTextarea",resultItemTitle:"ImageUpload-module__5r8nlq__resultItemTitle",resultItemValue:"ImageUpload-module__5r8nlq__resultItemValue",results:"ImageUpload-module__5r8nlq__results",resultsCount:"ImageUpload-module__5r8nlq__resultsCount",resultsHeader:"ImageUpload-module__5r8nlq__resultsHeader",resultsList:"ImageUpload-module__5r8nlq__resultsList",resultsTitle:"ImageUpload-module__5r8nlq__resultsTitle",saveButtons:"ImageUpload-module__5r8nlq__saveButtons",spin:"ImageUpload-module__5r8nlq__spin",success:"ImageUpload-module__5r8nlq__success",title:"ImageUpload-module__5r8nlq__title",uploadArea:"ImageUpload-module__5r8nlq__uploadArea",uploadHint:"ImageUpload-module__5r8nlq__uploadHint",uploadIcon:"ImageUpload-module__5r8nlq__uploadIcon",uploadText:"ImageUpload-module__5r8nlq__uploadText"})},92922,a=>{"use strict";var b=a.i(56993),c=a.i(91108),d=a.i(3859),e=a.i(98295),f=a.i(24050),g=a.i(59878);function h(){let a=(0,d.useRouter)(),h=(0,c.useRef)(null),[i,j]=(0,c.useState)(null),[k,l]=(0,c.useState)(null),[m,n]=(0,c.useState)(""),[o,p]=(0,c.useState)(!1),[q,r]=(0,c.useState)(!1),[s,t]=(0,c.useState)([]),[u,v]=(0,c.useState)([]),[w,x]=(0,c.useState)(null),[y,z]=(0,c.useState)(!1),A=a=>{if(!a.type.startsWith("image/"))return void alert("ç”»åƒãƒ•ã‚¡ã‚¤ãƒ«ã‚’é¸æŠžã—ã¦ãã ã•ã„");j(a),x(null),z(!1);let b=new FileReader;b.onload=a=>{l(a.target?.result)},b.readAsDataURL(a)},B=async()=>{if(i&&k)try{r(!0),x(null);let b=new FormData;b.append("image",k),b.append("name",m||"");let c=await fetch("/api/ocr",{method:"POST",body:b}),d=await c.json();if(d.success&&d.data){t(d.data);let b=(0,f.formatDate)(new Date),c=d.data.map(a=>{let c=e.CATEGORIES.find(b=>b.value===a.category);return{date:a.date||b,startTime:a.startTime||"09:00",endTime:a.endTime||"10:00",title:a.title,description:a.description||"",category:a.category||"other",color:c?.defaultColor||e.CATEGORIES[3].defaultColor,completed:!1}}),g=a=>(a||"").normalize("NFKC").toLowerCase().replace(/\s+/g,"").replace(/[\p{P}\p{S}]/gu,""),h=(a,b)=>{let c=Array.from({length:a.length+1},()=>Array(b.length+1).fill(0));for(let b=0;b<=a.length;b++)c[b][0]=b;for(let a=0;a<=b.length;a++)c[0][a]=a;for(let d=1;d<=a.length;d++)for(let e=1;e<=b.length;e++){let f=+(a[d-1]!==b[e-1]);c[d][e]=Math.min(c[d-1][e]+1,c[d][e-1]+1,c[d-1][e-1]+f)}return c[a.length][b.length]},i=c;if(m&&m.trim()){let a=g(m.trim());i=c.filter((b,c)=>((b,c)=>{if(c?.assignedTo&&c.assignedTo.length>0){for(let b of c.assignedTo){let c=g(b);if(!c)continue;if(c.includes(a)||a.includes(c))return!0;let d=Math.max(1,Math.floor(.3*Math.max(a.length,c.length)));if(h(c,a)<=d)return!0}return!1}for(let d of[b.title,b.description,c&&c.rawText||""].filter(Boolean).map(a=>g(String(a))))if(d.includes(a)||a.includes(d)||h(d,a)<=Math.max(1,Math.floor(.25*a.length)))return!0;return!1})(b,d.data[c]))}if(v(i),i.length>0)try{r(!0);let b=await fetch("/api/schedules",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(i)}),c=await b.json();if(c.success){let b=i[0].date;a.push(`/?focus=${encodeURIComponent(b)}`),a.refresh();return}x(c.error||"è‡ªå‹•ä¿å­˜ã«å¤±æ•—ã—ã¾ã—ãŸ")}catch(a){console.error("Auto-save error:",a),x("è‡ªå‹•ä¿å­˜ä¸­ã«ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ")}finally{r(!1)}}else x(d.error||"äºˆå®šã®æŠ½å‡ºã«å¤±æ•—ã—ã¾ã—ãŸ")}catch(a){console.error("OCR error:",a),x("OCRå‡¦ç†ä¸­ã«ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ")}finally{r(!1)}},C=!!m.trim()&&!!i&&!!k,D=(a,b,c)=>{v(d=>{let f=[...d];if(f[a]={...f[a],[b]:c},"category"===b){let b=e.CATEGORIES.find(a=>a.value===c);b&&(f[a].color=b.defaultColor)}return f})},E=async()=>{if(0!==u.length){if(u.some(a=>!a.title.trim()||!a.date||!a.startTime||!a.endTime))return void alert("ã™ã¹ã¦ã®å¿…é ˆé …ç›®ã‚’å…¥åŠ›ã—ã¦ãã ã•ã„");try{r(!0),x(null);let b=await fetch("/api/schedules",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(u)}),c=await b.json();c.success?(z(!0),setTimeout(()=>{a.push("/schedules"),a.refresh()},1500)):x(c.error||"ä¿å­˜ã«å¤±æ•—ã—ã¾ã—ãŸ")}catch(a){console.error("Save error:",a),x("ä¿å­˜ä¸­ã«ã‚¨ãƒ©ãƒ¼ãŒç™ºç”Ÿã—ã¾ã—ãŸ")}finally{r(!1)}}},F=()=>{j(null),l(null),t([]),v([]),x(null),z(!1),h.current&&(h.current.value="")};return(0,b.jsxs)("div",{className:g.default.container,children:[(0,b.jsx)("h1",{className:g.default.title,children:"ç”»åƒã‹ã‚‰äºˆå®šã‚’èª­ã¿è¾¼ã‚€"}),!i&&(0,b.jsxs)(b.Fragment,{children:[(0,b.jsxs)("div",{className:`${g.default.uploadArea} ${o?g.default.dragOver:""}`,onClick:()=>{h.current?.click()},onDragOver:a=>{a.preventDefault(),p(!0)},onDragLeave:()=>{p(!1)},onDrop:a=>{a.preventDefault(),p(!1);let b=a.dataTransfer.files[0];b&&A(b)},children:[(0,b.jsx)("div",{className:g.default.uploadIcon,children:"ðŸ“·"}),(0,b.jsx)("div",{className:g.default.uploadText,children:"ã‚¯ãƒªãƒƒã‚¯ã¾ãŸã¯ãƒ‰ãƒ©ãƒƒã‚°ï¼†ãƒ‰ãƒ­ãƒƒãƒ—ã§ç”»åƒã‚’ã‚¢ãƒƒãƒ—ãƒ­ãƒ¼ãƒ‰"}),(0,b.jsx)("div",{className:g.default.uploadHint,children:"ã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ã‚„æ‰‹å¸³ã®å†™çœŸã‹ã‚‰äºˆå®šã‚’è‡ªå‹•æŠ½å‡ºã—ã¾ã™"})]}),(0,b.jsx)("input",{ref:h,type:"file",accept:"image/*",onChange:a=>{let b=a.target.files?.[0];b&&A(b)},className:g.default.fileInput})]}),(0,b.jsxs)("div",{style:{marginTop:12},children:[(0,b.jsx)("label",{style:{display:"block",marginBottom:6},children:"åå‰ï¼ˆæŠ½å‡ºå¯¾è±¡ï¼‰"}),(0,b.jsx)("input",{type:"text",value:m,onChange:a=>n(a.target.value),placeholder:"ä¾‹: ç”°ä¸­ å¤ªéƒŽ",style:{padding:8,width:"100%",maxWidth:360}})]}),i&&k&&!q&&0===u.length&&(0,b.jsxs)("div",{className:g.default.preview,children:[(0,b.jsx)("img",{src:k,alt:"Preview",className:g.default.previewImage}),(0,b.jsxs)("div",{className:g.default.previewActions,children:[(0,b.jsx)("button",{className:`${g.default.button} ${g.default.buttonSecondary}`,onClick:F,children:"åˆ¥ã®ç”»åƒã‚’é¸æŠž"}),(0,b.jsx)("button",{className:`${g.default.button} ${g.default.buttonPrimary}`,onClick:B,disabled:!C,title:C?"äºˆå®šã‚’æŠ½å‡º":"ç”»åƒã¨æŠ½å‡ºå¯¾è±¡ã®åå‰ã‚’æŒ‡å®šã—ã¦ãã ã•ã„",children:"äºˆå®šã‚’æŠ½å‡º"})]})]}),q&&(0,b.jsxs)("div",{className:g.default.loading,children:[(0,b.jsx)("div",{className:g.default.loadingSpinner}),(0,b.jsx)("div",{className:g.default.loadingText,children:0===u.length?"ç”»åƒã‚’è§£æžä¸­...":"äºˆå®šã‚’ä¿å­˜ä¸­..."})]}),w&&(0,b.jsx)("div",{className:g.default.error,children:w}),y&&(0,b.jsx)("div",{className:g.default.success,children:"äºˆå®šã‚’ä¿å­˜ã—ã¾ã—ãŸï¼äºˆå®šä¸€è¦§ãƒšãƒ¼ã‚¸ã«ç§»å‹•ã—ã¾ã™..."}),u.length>0&&!y&&(0,b.jsxs)("div",{className:g.default.results,children:[(0,b.jsxs)("div",{className:g.default.resultsHeader,children:[(0,b.jsx)("h2",{className:g.default.resultsTitle,children:"æŠ½å‡ºã•ã‚ŒãŸäºˆå®š"}),(0,b.jsxs)("p",{className:g.default.resultsCount,children:[u.length,"ä»¶ã®äºˆå®šãŒè¦‹ã¤ã‹ã‚Šã¾ã—ãŸ"]})]}),(0,b.jsx)("div",{className:g.default.resultsList,children:u.map((a,c)=>{let d=e.CATEGORIES.find(b=>b.value===a.category);return(0,b.jsxs)("div",{className:g.default.resultItem,children:[(0,b.jsxs)("div",{className:g.default.resultItemHeader,children:[(0,b.jsx)("input",{type:"text",value:a.title,onChange:a=>D(c,"title",a.target.value),className:g.default.resultItemTitle,style:{border:"none",outline:"none",width:"100%"}}),(0,b.jsx)("span",{className:g.default.resultItemBadge,style:{backgroundColor:a.color},children:d?.label})]}),(0,b.jsxs)("div",{className:g.default.resultItemRow,children:[(0,b.jsxs)("div",{className:g.default.resultItemField,children:[(0,b.jsx)("label",{className:g.default.resultItemLabel,children:"æ—¥ä»˜"}),(0,b.jsx)("input",{type:"date",value:a.date,onChange:a=>D(c,"date",a.target.value),className:g.default.resultItemInput})]}),(0,b.jsxs)("div",{className:g.default.resultItemField,children:[(0,b.jsx)("label",{className:g.default.resultItemLabel,children:"é–‹å§‹æ™‚é–“"}),(0,b.jsx)("input",{type:"time",value:a.startTime,onChange:a=>D(c,"startTime",a.target.value),className:g.default.resultItemInput})]}),(0,b.jsxs)("div",{className:g.default.resultItemField,children:[(0,b.jsx)("label",{className:g.default.resultItemLabel,children:"çµ‚äº†æ™‚é–“"}),(0,b.jsx)("input",{type:"time",value:a.endTime,onChange:a=>D(c,"endTime",a.target.value),className:g.default.resultItemInput})]}),(0,b.jsxs)("div",{className:g.default.resultItemField,children:[(0,b.jsx)("label",{className:g.default.resultItemLabel,children:"ã‚«ãƒ†ã‚´ãƒªãƒ¼"}),(0,b.jsx)("select",{value:a.category,onChange:a=>D(c,"category",a.target.value),className:g.default.resultItemSelect,children:e.CATEGORIES.map(a=>(0,b.jsx)("option",{value:a.value,children:a.label},a.value))})]})]}),(0,b.jsxs)("div",{className:g.default.resultItemField,children:[(0,b.jsx)("label",{className:g.default.resultItemLabel,children:"è©³ç´°"}),(0,b.jsx)("textarea",{value:a.description,onChange:a=>D(c,"description",a.target.value),className:g.default.resultItemTextarea,placeholder:"äºˆå®šã®è©³ç´°..."})]})]},c)})}),(0,b.jsxs)("div",{className:g.default.saveButtons,children:[(0,b.jsx)("button",{className:`${g.default.button} ${g.default.buttonSecondary}`,onClick:F,disabled:q,children:"ã‚­ãƒ£ãƒ³ã‚»ãƒ«"}),(0,b.jsx)("button",{className:`${g.default.button} ${g.default.buttonPrimary}`,onClick:E,disabled:q,children:"ã™ã¹ã¦ä¿å­˜"})]})]})]})}a.s(["default",()=>h])}];

//# sourceMappingURL=%5Broot-of-the-server%5D__5c734643._.js.map