module.exports=[10796,(t,e,r)=>{function n(t,e){"boolean"==typeof e&&(e={forever:e}),this._originalTimeouts=JSON.parse(JSON.stringify(t)),this._timeouts=t,this._options=e||{},this._maxRetryTime=e&&e.maxRetryTime||1/0,this._fn=null,this._errors=[],this._attempts=1,this._operationTimeout=null,this._operationTimeoutCb=null,this._timeout=null,this._operationStart=null,this._timer=null,this._options.forever&&(this._cachedTimeouts=this._timeouts.slice(0))}e.exports=n,n.prototype.reset=function(){this._attempts=1,this._timeouts=this._originalTimeouts.slice(0)},n.prototype.stop=function(){this._timeout&&clearTimeout(this._timeout),this._timer&&clearTimeout(this._timer),this._timeouts=[],this._cachedTimeouts=null},n.prototype.retry=function(t){if(this._timeout&&clearTimeout(this._timeout),!t)return!1;var e=new Date().getTime();if(t&&e-this._operationStart>=this._maxRetryTime)return this._errors.push(t),this._errors.unshift(Error("RetryOperation timeout occurred")),!1;this._errors.push(t);var r=this._timeouts.shift();if(void 0===r)if(!this._cachedTimeouts)return!1;else this._errors.splice(0,this._errors.length-1),r=this._cachedTimeouts.slice(-1);var n=this;return this._timer=setTimeout(function(){n._attempts++,n._operationTimeoutCb&&(n._timeout=setTimeout(function(){n._operationTimeoutCb(n._attempts)},n._operationTimeout),n._options.unref&&n._timeout.unref()),n._fn(n._attempts)},r),this._options.unref&&this._timer.unref(),!0},n.prototype.attempt=function(t,e){this._fn=t,e&&(e.timeout&&(this._operationTimeout=e.timeout),e.cb&&(this._operationTimeoutCb=e.cb));var r=this;this._operationTimeoutCb&&(this._timeout=setTimeout(function(){r._operationTimeoutCb()},r._operationTimeout)),this._operationStart=new Date().getTime(),this._fn(this._attempts)},n.prototype.try=function(t){console.log("Using RetryOperation.try() is deprecated"),this.attempt(t)},n.prototype.start=function(t){console.log("Using RetryOperation.start() is deprecated"),this.attempt(t)},n.prototype.start=n.prototype.try,n.prototype.errors=function(){return this._errors},n.prototype.attempts=function(){return this._attempts},n.prototype.mainError=function(){if(0===this._errors.length)return null;for(var t={},e=null,r=0,n=0;n<this._errors.length;n++){var i=this._errors[n],o=i.message,s=(t[o]||0)+1;t[o]=s,s>=r&&(e=i,r=s)}return e}},57329,(t,e,r)=>{var n=t.r(10796);r.operation=function(t){return new n(r.timeouts(t),{forever:t&&(t.forever||t.retries===1/0),unref:t&&t.unref,maxRetryTime:t&&t.maxRetryTime})},r.timeouts=function(t){if(t instanceof Array)return[].concat(t);var e={retries:10,factor:2,minTimeout:1e3,maxTimeout:1/0,randomize:!1};for(var r in t)e[r]=t[r];if(e.minTimeout>e.maxTimeout)throw Error("minTimeout is greater than maxTimeout");for(var n=[],i=0;i<e.retries;i++)n.push(this.createTimeout(i,e));return t&&t.forever&&!n.length&&n.push(this.createTimeout(i,e)),n.sort(function(t,e){return t-e}),n},r.createTimeout=function(t,e){var r=Math.round((e.randomize?Math.random()+1:1)*Math.max(e.minTimeout,1)*Math.pow(e.factor,t));return Math.min(r,e.maxTimeout)},r.wrap=function(t,e,n){if(e instanceof Array&&(n=e,e=null),!n)for(var i in n=[],t)"function"==typeof t[i]&&n.push(i);for(var o=0;o<n.length;o++){var s=n[o],a=t[s];t[s]=(function(n){var i=r.operation(e),o=Array.prototype.slice.call(arguments,1),s=o.pop();o.push(function(t){i.retry(t)||(t&&(arguments[0]=i.mainError()),s.apply(this,arguments))}),i.attempt(function(){n.apply(t,o)})}).bind(t,a),t[s].options=e}}},14172,(t,e,r)=>{e.exports=t.r(57329)},13352,(t,e,r)=>{var n=t.r(14172);e.exports=function(t,e){return new Promise(function(r,i){var o,s=e||{};function a(t){i(t||Error("Aborted"))}function u(t,e){t.bail?a(t):o.retry(t)?s.onRetry&&s.onRetry(t,e):i(o.mainError())}"randomize"in s||(s.randomize=!0),(o=n.operation(s)).attempt(function(e){var n;try{n=t(a,e)}catch(t){u(t,e);return}Promise.resolve(n).then(r).catch(function(t){u(t,e)})})})}},24868,(t,e,r)=>{e.exports=t.x("fs/promises",()=>require("fs/promises"))},35183,t=>{"use strict";var e=t.i(13352);function r(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function n(t,e,r,n,i,o,s){try{var a=t[o](s),u=a.value}catch(t){r(t);return}a.done?e(u):Promise.resolve(u).then(n,i)}function i(t){return function(){var e=this,r=arguments;return new Promise(function(i,o){var s=t.apply(e,r);function a(t){n(s,i,o,a,u,"next",t)}function u(t){n(s,i,o,a,u,"throw",t)}a(void 0)})}}function o(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{},n=Object.keys(r);"function"==typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(r).filter(function(t){return Object.getOwnPropertyDescriptor(r,t).enumerable}))),n.forEach(function(e){var n;n=r[e],e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n})}return t}function s(t,e){return e=null!=e?e:{},Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(e)):(function(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);r.push.apply(r,n)}return r})(Object(e)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(e,r))}),t}function a(t){return function(t){if(Array.isArray(t))return r(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||u(t)||function(){throw TypeError("Invalid attempt to spread non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function u(t,e){if(t){if("string"==typeof t)return r(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if("Object"===n&&t.constructor&&(n=t.constructor.name),"Map"===n||"Set"===n)return Array.from(n);if("Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return r(t,e)}}function c(t,e){var r,n,i,o,s={label:0,sent:function(){if(1&i[0])throw i[1];return i[1]},trys:[],ops:[]};return o={next:a(0),throw:a(1),return:a(2)},"function"==typeof Symbol&&(o[Symbol.iterator]=function(){return this}),o;function a(o){return function(a){var u=[o,a];if(r)throw TypeError("Generator is already executing.");for(;s;)try{if(r=1,n&&(i=2&u[0]?n.return:u[0]?n.throw||((i=n.return)&&i.call(n),0):n.next)&&!(i=i.call(n,u[1])).done)return i;switch(n=0,i&&(u=[2&u[0],i.value]),u[0]){case 0:case 1:i=u;break;case 4:return s.label++,{value:u[1],done:!1};case 5:s.label++,n=u[1],u=[0];continue;case 7:u=s.ops.pop(),s.trys.pop();continue;default:if(!(i=(i=s.trys).length>0&&i[i.length-1])&&(6===u[0]||2===u[0])){s=0;continue}if(3===u[0]&&(!i||u[1]>i[0]&&u[1]<i[3])){s.label=u[1];break}if(6===u[0]&&s.label<i[1]){s.label=i[1],i=u;break}if(i&&s.label<i[2]){s.label=i[2],s.ops.push(u);break}i[2]&&s.ops.pop(),s.trys.pop();continue}u=e.call(t,s)}catch(t){u=[6,t],n=0}finally{r=i=0}if(5&u[0])throw u[1];return{value:u[0]?u[1]:void 0,done:!0}}}}var l=function(t){var e;return e=i(function(e,r){var n;return c(this,function(i){return[2,((n=new Headers(null==r?void 0:r.headers)).has("X-MICROCMS-API-KEY")||n.set("X-MICROCMS-API-KEY",t),fetch(e,s(o({},r),{headers:n})))]})}),function(t,r){return e.apply(this,arguments)}},f=function(t){return"string"==typeof t},p=function(t){if(null===t||"object"!=typeof t)throw Error("queries is not object");return new URLSearchParams(Object.entries(t).reduce(function(t,e){var r=function(t){if(Array.isArray(t))return t}(e)||function(t,e){var r,n,i=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=i){var o=[],s=!0,a=!1;try{for(i=i.call(t);!(s=(r=i.next()).done)&&(o.push(r.value),2!==o.length);s=!0);}catch(t){a=!0,n=t}finally{try{s||null==i.return||i.return()}finally{if(a)throw n}}return o}}(e,2)||u(e,2)||function(){throw TypeError("Invalid attempt to destructure non-iterable instance.\\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}(),n=r[0],i=r[1];return void 0!==i&&(t[n]=String(i)),t},{})).toString()},d=t.i(24868),h=t.i(14747);let m=process.env.MICROCMS_SERVICE_DOMAIN&&process.env.MICROCMS_API_KEY?function(t){var r,n,u,d,h,m,y,v,b,w,g=t.serviceDomain,_=t.apiKey,I=t.retry;if(!g||!_)throw Error("parameter is required (check serviceDomain and apiKey)");if(!f(g)||!f(_))throw Error("parameter is not string");var S="https://".concat(g,".").concat("microcms.io","/api/").concat("v1"),T=(r=i(function(t){var r,n,a,u,f,d,h,m,y;return c(this,function(v){switch(v.label){case 0:var b,w;return r=t.endpoint,n=t.contentId,u=void 0===(a=t.queries)?{}:a,f=t.requestInit,d=l(_),h=p(u),m="".concat(S,"/").concat(r).concat(n?"/".concat(n):"").concat(h?"?".concat(h):""),b=i(function(t){var e;return c(this,function(r){switch(r.label){case 0:return r.trys.push([0,2,,3]),[4,t.json()];case 1:return[2,null!=(e=r.sent().message)?e:null];case 2:return r.sent(),[2,null];case 3:return[2]}})}),y=function(t){return b.apply(this,arguments)},[4,(0,e.default)((w=i(function(t){var e,r,n,i,a,u,l;return c(this,function(c){switch(c.label){case 0:return c.trys.push([0,6,,7]),[4,d(m,s(o({},f),{method:null!=(r=null==f?void 0:f.method)?r:"GET"}))];case 1:if(429===(e=c.sent()).status||!(e.status>=400)||!(e.status<500))return[3,3];return[4,y(e)];case 2:return n=c.sent(),[2,t(Error("fetch API response status: ".concat(e.status).concat(n?"\n  message is `".concat(n,"`"):"")))];case 3:if(e.ok)return[3,5];return[4,y(e)];case 4:return i=c.sent(),[2,Promise.reject(Error("fetch API response status: ".concat(e.status).concat(i?"\n  message is `".concat(i,"`"):"")))];case 5:return[2,(null==f?void 0:f.method)==="DELETE"?void 0:e.json()];case 6:if((a=c.sent()).data)throw a.data;if(null==(u=a.response)?void 0:u.data)throw a.response.data;return[2,Promise.reject(Error("Network Error.\n  Details: ".concat(null!=(l=a.message)?l:"")))];case 7:return[2]}})}),function(t){return w.apply(this,arguments)}),{retries:2*!!I,onRetry:function(t,e){console.log(t),console.log("Waiting for retry (".concat(e,"/",2,")"))},minTimeout:5e3})];case 1:return[2,v.sent()]}})}),function(t){return r.apply(this,arguments)});return{get:(n=i(function(t){var e,r,n,i,o,s;return c(this,function(a){switch(a.label){case 0:if(e=t.endpoint,r=t.contentId,i=void 0===(n=t.queries)?{}:n,o=t.customRequestInit,!e)return[3,2];return[4,T({endpoint:e,contentId:r,queries:i,requestInit:o})];case 1:return s=a.sent(),[3,3];case 2:s=Promise.reject(Error("endpoint is required")),a.label=3;case 3:return[2,s]}})}),function(t){return n.apply(this,arguments)}),getList:(u=i(function(t){var e,r,n,i,o;return c(this,function(s){switch(s.label){case 0:if(e=t.endpoint,n=void 0===(r=t.queries)?{}:r,i=t.customRequestInit,!e)return[3,2];return[4,T({endpoint:e,queries:n,requestInit:i})];case 1:return o=s.sent(),[3,3];case 2:o=Promise.reject(Error("endpoint is required")),s.label=3;case 3:return[2,o]}})}),function(t){return u.apply(this,arguments)}),getListDetail:(d=i(function(t){var e,r,n,i,o,s;return c(this,function(a){switch(a.label){case 0:if(e=t.endpoint,r=t.contentId,i=void 0===(n=t.queries)?{}:n,o=t.customRequestInit,!e)return[3,2];return[4,T({endpoint:e,contentId:r,queries:i,requestInit:o})];case 1:return s=a.sent(),[3,3];case 2:s=Promise.reject(Error("endpoint is required")),a.label=3;case 3:return[2,s]}})}),function(t){return d.apply(this,arguments)}),getObject:(h=i(function(t){var e,r,n,i,o;return c(this,function(s){switch(s.label){case 0:if(e=t.endpoint,n=void 0===(r=t.queries)?{}:r,i=t.customRequestInit,!e)return[3,2];return[4,T({endpoint:e,queries:n,requestInit:i})];case 1:return o=s.sent(),[3,3];case 2:o=Promise.reject(Error("endpoint is required")),s.label=3;case 3:return[2,o]}})}),function(t){return h.apply(this,arguments)}),getAllContentIds:(m=i(function(t){var e,r,n,i,u,l,f,p,d,h,m,y,v;return c(this,function(c){switch(c.label){case 0:return e=t.endpoint,r=t.alternateField,n=t.draftKey,i=t.filters,u=t.orders,l=t.customRequestInit,[4,T({endpoint:e,queries:s(o({},f={draftKey:n,filters:i,orders:u,limit:100,fields:null!=r?r:"id",depth:0}),{limit:0}),requestInit:l})];case 1:p=c.sent().totalCount,d=[],h=0,m=function(t){return new Promise(function(e){return setTimeout(e,t)})},y=function(t){return t.every(function(t){return"string"==typeof t})},c.label=2;case 2:if(!(d.length<p))return[3,7];return[4,T({endpoint:e,queries:s(o({},f),{offset:h}),requestInit:l})];case 3:if(v=c.sent().contents.map(function(t){return t[null!=r?r:"id"]}),!y(v))throw Error("The value of the field specified by `alternateField` is not a string.");if(d=a(d).concat(a(v)),h+=100,!(d.length<p))return[3,5];return[4,m(1e3)];case 4:c.sent(),c.label=5;case 5:c.label=6;case 6:return[3,2];case 7:return[2,d]}})}),function(t){return m.apply(this,arguments)}),getAllContents:(y=i(function(t){var e,r,n,i,a,u,l,f,p;return c(this,function(c){switch(c.label){case 0:return e=t.endpoint,n=void 0===(r=t.queries)?{}:r,i=t.customRequestInit,[4,T({endpoint:e,queries:s(o({},n),{limit:0}),requestInit:i})];case 1:a=c.sent().totalCount,u=[],l=0,f=function(t){return new Promise(function(e){return setTimeout(e,t)})},c.label=2;case 2:if(!(u.length<a))return[3,7];return[4,T({endpoint:e,queries:s(o({},n),{limit:100,offset:l}),requestInit:i})];case 3:if(p=c.sent().contents,u=u.concat(p),l+=100,!(u.length<a))return[3,5];return[4,f(1e3)];case 4:c.sent(),c.label=5;case 5:c.label=6;case 6:return[3,2];case 7:return[2,u]}})}),function(t){return y.apply(this,arguments)}),create:(v=i(function(t){var e,r,n,i,a,u,l,f;return c(this,function(c){return(e=t.endpoint,r=t.contentId,n=t.content,a=void 0!==(i=t.isDraft)&&i,u=t.customRequestInit,e)?(l=a?{status:"draft"}:{},f=s(o({},u),{method:r?"PUT":"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)}),[2,T({endpoint:e,contentId:r,queries:l,requestInit:f})]):[2,Promise.reject(Error("endpoint is required"))]})}),function(t){return v.apply(this,arguments)}),update:(b=i(function(t){var e,r,n,i;return c(this,function(a){return(e=t.endpoint,r=t.contentId,n=t.content,i=t.customRequestInit,e)?[2,T({endpoint:e,contentId:r,requestInit:s(o({},i),{method:"PATCH",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)})})]:[2,Promise.reject(Error("endpoint is required"))]})}),function(t){return b.apply(this,arguments)}),delete:(w=i(function(t){var e,r,n;return c(this,function(i){switch(i.label){case 0:if(e=t.endpoint,r=t.contentId,n=t.customRequestInit,!e)return[2,Promise.reject(Error("endpoint is required"))];if(!r)return[2,Promise.reject(Error("contentId is required"))];return[4,T({endpoint:e,contentId:r,requestInit:s(o({},n),{method:"DELETE",headers:{},body:void 0})})];case 1:return i.sent(),[2]}})}),function(t){return w.apply(this,arguments)})}}({serviceDomain:process.env.MICROCMS_SERVICE_DOMAIN,apiKey:process.env.MICROCMS_API_KEY}):null,y=h.default.resolve(process.cwd(),"data","schedules.json");async function v(){await d.default.mkdir(h.default.dirname(y),{recursive:!0});try{await d.default.access(y)}catch(t){await d.default.writeFile(y,"[]","utf8")}}async function b(){try{await v();let t=await d.default.readFile(y,"utf8");return JSON.parse(t||"[]")}catch(t){return console.error("Failed to load local store:",t),[]}}async function w(t){try{await v(),await d.default.writeFile(y,JSON.stringify(t,null,2),"utf8")}catch(t){console.error("Failed to save local store:",t)}}async function g(t,e){try{if(!m){let r=await b();if(t&&e){let n=`${t}-${String(e).padStart(2,"0")}`;return r.filter(t=>t.date.startsWith(n))}return[...r]}let r="";if(t&&e){let n=`${t}-${String(e).padStart(2,"0")}-01`,i=`${t}-${String(e).padStart(2,"0")}-31`;r=`date[greater_than]${n}[and]date[less_than]${i}`}return(await m.get({endpoint:"schedules",queries:{limit:100,orders:"date",...r&&{filters:r}}})).contents}catch(t){throw console.error("Failed to fetch schedules:",t),t}}async function _(t){try{if(!m){let e=(await b()).find(e=>e.id===t);if(!e)throw Error(`Schedule ${t} not found`);return e}return await m.get({endpoint:"schedules",contentId:t})}catch(e){throw console.error(`Failed to fetch schedule ${t}:`,e),e}}async function I(t){try{if(!m){let e=await b(),r=`${Date.now()}-${Math.random().toString(36).slice(2,9)}`,n=new Date().toISOString(),i={...t,id:r,completed:t.completed??!1,createdAt:n,updatedAt:n};return e.push(i),await w(e),i}let e=await m.create({endpoint:"schedules",content:{...t,completed:t.completed??!1}});return{...t,id:e.id,completed:t.completed??!1,createdAt:new Date().toISOString(),updatedAt:new Date().toISOString()}}catch(t){throw console.error("Failed to create schedule:",t),t}}async function S(t,e){try{if(!m){let r=await b(),n=r.findIndex(e=>e.id===t);if(-1===n)throw Error(`Schedule ${t} not found`);let i={...r[n],...e,updatedAt:new Date().toISOString()};return r[n]=i,await w(r),i}return await m.update({endpoint:"schedules",contentId:t,content:e}),await _(t)}catch(e){throw console.error(`Failed to update schedule ${t}:`,e),e}}async function T(t){try{if(!m){let e=await b(),r=e.findIndex(e=>e.id===t);if(-1===r)throw Error(`Schedule ${t} not found`);e.splice(r,1),await w(e);return}await m.delete({endpoint:"schedules",contentId:t})}catch(e){throw console.error(`Failed to delete schedule ${t}:`,e),e}}async function q(t){try{return await Promise.all(t.map(t=>I(t)))}catch(t){throw console.error("Failed to create schedules in bulk:",t),t}}t.s(["createSchedule",()=>I,"createScheduleBulk",()=>q,"deleteSchedule",()=>T,"getSchedule",()=>_,"getSchedules",()=>g,"updateSchedule",()=>S],35183)}];

//# sourceMappingURL=%5Broot-of-the-server%5D__bd151d8f._.js.map